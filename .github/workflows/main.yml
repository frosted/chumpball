name: StatPull
on: 
    workflow_dispatch:
    #schedule:
        #- cron: '0 11 * * *' # Runs every day at 11:00 AM UTC (7:00 AM EST)

jobs:
    build:
      name: Run Script
      runs-on: windows-latest
      steps:
        - uses: actions/checkout@v1
        - name: Install Join-Object module
          shell: pwsh
          run: Install-Module -Name Join-Object -Force
        - name: Install PSParseHTML module
          shell: pwsh
          run: Install-Module -Name PSParseHTML -Force
        - name: Install PSWriteHTML module
          shell: pwsh
          run: Install-Module -Name PSWriteHTML -Force
        - name: Install PowerHTML module
          shell: pwsh
          run: Install-Module -Name PowerHTML -Force -AllowClobber
        - name: Script
          run: .\Get-Stats.ps1
            $commitMsg = "[$(get-date -Format 'yyyy.MM.dd:hh.mm.ss')]Updated stats"
            git config user.name github-actions[bot]
            git config user.email github-actions[bot]@users.noreply.github.com
            git add .\dashboard.html
            git commit -m $commitMsg
          shell: pwsh
        - name: Push changes # push the output folder to your repo
          uses: ad-m/github-push-action@master
          with:
            github_token: ${{ secrets.CHUMPBALL_TOKEN  }}
            force: true
          

